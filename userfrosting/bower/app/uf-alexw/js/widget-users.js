/*! srinivas 2015-07-24 , 6:53:27 PM */
function updateUserEnabledStatus(a,b){b="undefined"!=typeof b?b:1,csrf_token=$("meta[name=csrf_token]").attr("content");var c={enabled:b,csrf_token:csrf_token},d=site.uri["public"]+"/users/u/"+a;return $.ajax({type:"POST",url:d,data:c})}function updateUserActiveStatus(a){csrf_token=$("meta[name=csrf_token]").attr("content");var b={active:"1",csrf_token:csrf_token},c=site.uri["public"]+"/users/u/"+a;return $.ajax({type:"POST",url:c,data:b})}function deleteUserDialog(a,b,c){$("#"+a).length&&$("#"+a).remove();var d=site.uri["public"]+"/forms/confirm",e={box_id:a,box_title:"Delete User",confirm_message:"Are you sure you want to delete the user "+c+"?",confirm_button:"Yes, delete user"};$.ajax({type:"GET",url:d,data:e}).fail(function(a){$("#userfrosting-alerts").flashAlerts().done(function(){})}).done(function(c){$("body").append(c),$("#"+a).modal("show"),$("#"+a+" .js-confirm").click(function(){var c=site.uri["public"]+"/users/u/"+b+"/delete";csrf_token=$("meta[name=csrf_token]").attr("content");var d={user_id:b,csrf_token:csrf_token};$.ajax({type:"POST",url:c,data:d}).done(function(a){window.location.reload()}).fail(function(b){1==site.debug?document.body.innerHTML=b.responseText:console.log("Error ("+b.status+"): "+b.responseText),$("#userfrosting-alerts").flashAlerts().done(function(){$("#"+a).modal("hide")})})})})}function userForm(a,b){b="undefined"!=typeof b?b:"",$("#"+a).length&&$("#"+a).remove();var c={box_id:a,render:"modal"},d=site.uri["public"]+"/forms/users";b&&(c={box_id:a,render:"modal",mode:"update"},d=site.uri["public"]+"/forms/users/u/"+b),$.ajax({type:"GET",url:d,data:c,cache:!1}).fail(function(a){$("#userfrosting-alerts").flashAlerts().done(function(){})}).done(function(b){$("body").append(b),$("#"+a).modal("show"),$("#"+a+" .select2").select2();var c=$("#"+a+" .bootstrapswitch");c.data("on-label",'<i class="fa fa-check"></i>'),c.data("off-label",'<i class="fa fa-times"></i>'),c.bootstrapSwitch(),c.bootstrapSwitch("setSizeClass","switch-mini"),$(".bootstrapradio").bootstrapradio(),c.on("switch-change",function(b,c){var d=c.el,e=d.data("id"),f=$("#"+a+' button.bootstrapradio[name="primary_group_id"][value="'+e+'"]');c.value?f.bootstrapradio("disabled",!1):f.bootstrapradio("disabled",!0)}),$("form[name='user']").formValidation({framework:"bootstrap",icon:{valid:"fa fa-check",invalid:"fa fa-times",validating:"fa fa-refresh"},fields:validators}).on("success.form.fv",function(a){a.preventDefault();var b=$(a.target),c=b.find("input, textarea, select").not(":checkbox").serialize();b.find("input[type=checkbox]:enabled").each(function(){c+=$(this).is(":checked")?"&"+encodeURIComponent(this.name)+"=1":"&"+encodeURIComponent(this.name)+"=0"});var d=$("meta[name=csrf_token]").attr("content");c+="&csrf_token="+encodeURIComponent(d);var e=b.attr("action");return $.ajax({type:"POST",url:e,data:c}).done(function(a,b,c){window.location.reload(!0)}).fail(function(a){1==site.debug?document.body.innerHTML=a.responseText:console.log("Error ("+a.status+"): "+a.responseText),$("#form-alerts").flashAlerts().done(function(){b.data("formValidation").disableSubmitButtons(!1)})})})})}function userDisplay(a,b){b="undefined"!=typeof b?b:"",$("#"+a).length&&$("#"+a).remove();var c={box_id:a,render:"modal",mode:"view"};$.ajax({type:"GET",url:site.uri["public"]+"/forms/users/u/"+b,data:c,cache:!1}).fail(function(a){$("#userfrosting-alerts").flashAlerts().done(function(){})}).done(function(c){var d=$("#"+a+' input[name="select_groups"]');d.data("on-label",'<i class="fa fa-check"></i>'),d.data("off-label",'<i class="fa fa-times"></i>'),d.bootstrapSwitch(),d.bootstrapSwitch("setSizeClass","switch-mini"),$(".bootstrapradio").bootstrapradio(),$("#"+a+" .js-user-edit").click(function(){userForm("dialog-user-edit",b)}),$("#"+a+" .js-user-activate").click(function(){updateUserActiveStatus(b)}),$("#"+a+" .js-user-enable").click(function(){updateUserEnabledStatus(b,"1")}),$("#"+a+" .js-user-disable").click(function(){updateUserEnabledStatus(b,"0")}),$("#"+a+" .js-user-delete").click(function(){var a=$(this).data("name");deleteUserDialog("delete-user-dialog",b,a),$("#dialog-user-delete").modal("show")})})}$(document).ready(function(){$(".js-user-create").click(function(){userForm("dialog-user-create")}),$(".js-user-edit").click(function(){var a=$(this),b=a.data("id");userForm("dialog-user-edit",b)}),$(".js-user-activate").click(function(){var a=$(this),b=a.data("id");updateUserActiveStatus(b).always(function(a){window.location.reload()})}),$(".js-user-enable").click(function(){var a=$(this),b=a.data("id");updateUserEnabledStatus(b,"1").always(function(a){window.location.reload()})}),$(".js-user-disable").click(function(){var a=$(this),b=a.data("id");updateUserEnabledStatus(b,"0").always(function(a){window.location.reload()})}),$(".js-user-delete").click(function(){var a=$(this),b=a.data("id"),c=a.data("user_name");deleteUserDialog("dialog-user-delete",b,c)})});